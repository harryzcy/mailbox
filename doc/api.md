# API

The current API uses AWS API Gateway, which invokes Lambda functions in `api/*`.

## Endpoint

Dev Endpoint: `https://{api_id}.execute-api.{region}.amazonaws.com/`

The default endpoint is generated by API Gateway. It can be found from your AWS console -> APIs -> \<your-api-name\> -> Settings -> Default Endpoint.

## Methods

### List

Lists emails based on query parameters.

`GET /emails/list`

Query String Parameters:

- `type`: `inbox` or `draft` or `sent`
- `year`: four digit year (default to current year)
- `month`: one or two digit month (default to current month)
  - e.g. for March, both `3` and `03` are supported
- `order`: `asc` or `desc` (default)
- `nextCursor`: cursor returned by List response (optional)

### Get

Get an email given it's messageID.

`GET /emails/{messageID}`

Path Parameters:

- `messageID`: id of the email message

### Trash

Trash an untrashed email given it's messageID.

`POST /emails/{messageID}/trash`

Path Parameters:

- `messageID`: id of the email message

Note: if the email is already trashed, 400 Bad Request will be returned. If the email is a draft, trash method is not supported.

### Untrash

Untrash an trashed email given it's messageID.

`POST /emails/{messageID}/untrash`

Path Parameters:

- `messageID`: id of the email message

Note: if the email is not trashed, 400 Bad Request will be returned. If the email is a draft, untrash method is not supported.

### Delete

Permanently delete an trashed email given it's messageID.

`DELETE /emails/{messageID}`

Path Parameters:

- `messageID`: id of the email message

Note: if the email is not trashed and email type is inbox or sent, 400 Bad Request will be returned.

### Create

Create a draft email.

`POST /emails/`

Request Body (JSON formatted):

| Field | Type | Description |
| ----- | ---- | ----------- |
| subject | string | Subject of email |
| from | string array | From addresses |
| to | string array | To addresses |
| cc | string array | Cc addresses |
| bcc | string array | Bcc addresses |
| replayTo | string array | ReplayTo addresses |
| text | string | email content in text |
| html | string | email content in HTML |
| generateText <sup>[1](#generateText)</sup> | string (optional) | `on`, `off`, or `auto` (default) |

Response:

| Field | Type | Description |
| ----- | ---- | ----------- |
| messageID | string | ID of created draft email |
| type | string | `draft` |
| subject | string | Subject of email |
| from | string array | From addresses |
| to | string array | To addresses |
| cc | string array | Cc addresses |
| bcc | string array | Bcc addresses |
| replayTo | string array | ReplayTo addresses |
| text | string | email content in text |
| html | string | email content in HTML |

### Save

Save a draft email, which is identified by messageID returned from 'Create' operation.

Note: this operation replaces the entire draft email,
so all fields must be supplied to it will be removed.

`PUT /emails/{messageID}`

Path Parameters:

- `messageID`: id of the email message

Request Body (JSON formatted):

| Field | Type | Description |
| ----- | ---- | ----------- |
| subject | string | Subject of email |
| from | string array | From addresses |
| to | string array | To addresses |
| cc | string array | Cc addresses |
| bcc | string array | Bcc addresses |
| replayTo | string array | ReplayTo addresses |
| text | string | email content in text |
| html | string | email content in HTML |
| generateText <sup>[1](#generateText)</sup> | string (optional) | `on`, `off`, or `auto` (default) |

Response:

| Field | Type | Description |
| ----- | ---- | ----------- |
| messageID | string | ID of saved draft email |
| type | string | `draft` |
| subject | string | Subject of email |
| from | string array | From addresses |
| to | string array | To addresses |
| cc | string array | Cc addresses |
| bcc | string array | Bcc addresses |
| replayTo | string array | ReplayTo addresses |
| text | string | email content in text |
| html | string | email content in HTML |

### Send

Send a draft email, which is identified by messageID.

`POST /emails/{messageID}/send`

Path Parameters:

- `messageID`: id of the email message

---

<a name="generateText">1</a>: Field `generateText`

- if `on`, text is always generated from html
- if `off`, text is never generated
- if `auto` (default), text is generated if text is empty
